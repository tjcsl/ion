<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Testing Ion &#8212; TJ Intranet v3 (Build #1269) documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Keeping things up-to-date" href="updates.html" />
    <link rel="prev" title="Coding Style Guide" href="styleguide.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          TJ Intranet</a>
        <span class="navbar-text navbar-version pull-left"><b>v3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Topics <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../setup/server.html">Setting up the Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../architecture/index.html#technologies">Technologies</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developing for Intranet</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="eighth-models.html">Understanding the Eighth models</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto.html">How to do Ion development</a></li>
<li class="toctree-l2"><a class="reference internal" href="oauth.html">Using OAuth</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements.html">Ion Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="styleguide.html">Coding Style Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Testing Ion</a></li>
<li class="toctree-l2"><a class="reference internal" href="updates.html">Keeping things up-to-date</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sourcedoc/modules.html">intranet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sourcedoc/intranet.html">intranet package</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Section <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Testing Ion</a><ul>
<li><a class="reference internal" href="#unit-tests">Unit Tests</a></li>
<li><a class="reference internal" href="#running-tests">Running Tests</a></li>
<li><a class="reference internal" href="#coverage">Coverage</a></li>
<li><a class="reference internal" href="#writing-tests">Writing Tests</a></li>
<li><a class="reference internal" href="#good-testing-examples">Good Testing Examples</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="testing-ion">
<h1>Testing Ion<a class="headerlink" href="#testing-ion" title="Permalink to this heading">¶</a></h1>
<p>Unit tests are hugely important to ensuring that Ion functions as expected. By writing and running tests before deploying every change, we can be much more confident that our new changes don’t break the existing design in Ion. As such, every change that introduces a new feature should also include at least one unit test that corresponding to that feature.</p>
<section id="unit-tests">
<h2>Unit Tests<a class="headerlink" href="#unit-tests" title="Permalink to this heading">¶</a></h2>
<p>For most modules, the unit tests go in <code class="docutils literal notranslate"><span class="pre">intranet/apps/&lt;module&gt;/tests.py</span></code>. Currently, the sole exception is <code class="docutils literal notranslate"><span class="pre">eighth</span></code>, where tests are broken out into several different files under <code class="docutils literal notranslate"><span class="pre">intranet/apps/eighth/tests/</span></code>. Testing functionality that is useful for multiple tests can be found in <code class="docutils literal notranslate"><span class="pre">intranet/test</span></code>.</p>
</section>
<section id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Permalink to this heading">¶</a></h2>
<p>To actually execute tests, run <code class="docutils literal notranslate"><span class="pre">pytest</span></code> inside your dev environment. If you want to only test a specific app, you can run <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">&lt;apps_name&gt;</span></code>. Do note that this deletes and re-creates the db from scratch each time, so you may want to pass the <code class="docutils literal notranslate"><span class="pre">-k</span></code> option when developing tests as it significantly reduces run-time.</p>
</section>
<section id="coverage">
<h2>Coverage<a class="headerlink" href="#coverage" title="Permalink to this heading">¶</a></h2>
<p>Coverage information is auto-generated at <cite>Coveralls &lt;https://coveralls.io/github/tjcsl/ion&gt;</cite>. This is useful for finding files with insufficient coverage, so you can focus your test writing more accurately.</p>
</section>
<section id="writing-tests">
<h2>Writing Tests<a class="headerlink" href="#writing-tests" title="Permalink to this heading">¶</a></h2>
<p>Looking at pre-existing tests can give you a good idea how to structure your tests. The <code class="docutils literal notranslate"><span class="pre">IonTestCase</span></code> class is a wrapper around the standard Django test class. It handles some ion-specific logic, such as mocking out ldap queries. Here is an bare-bones example of the basic layout for a test:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">...test.ion_test</span> <span class="kn">import</span> <span class="n">IonTestCase</span>

<span class="k">class</span> <span class="nc">ModuleTest</span><span class="p">(</span><span class="n">IonTestCase</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">test_module_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Put your tests here</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Every test should include comments that explain, almost in narrative form, what the test is doing and what the expected results are.</p>
<p>Generally, there are two ways that you test Ion’s code. These are not comprehensive, but should work for most cases. The first is calling methods directly; the second is making a GET or POST request to the view that you are interested in testing. The best tests utilize both. After you do either/both of these to call the code, you should use assertions to see if the code behaved as expected. A list of assertion options can be found <a href="#id1"><span class="problematic" id="id2">`here &lt;https://docs.python.org/3/library/unittest`_</span></a>.html#assert-methods&gt;`. A useful tool for making requests to the view is <code class="docutils literal notranslate"><span class="pre">self.client</span></code>. More documentation on that can be found <a class="reference external" href="https://docs.djangoproject.com/en/3.2/topics/testing/tools/">here</a>. Alternatively, just search through Ion’s testing files for examples of using <cite>self.client</cite>.</p>
</section>
<section id="good-testing-examples">
<h2>Good Testing Examples<a class="headerlink" href="#good-testing-examples" title="Permalink to this heading">¶</a></h2>
<p>Ion has lots of tests; the following are examples of very well-written ones. Note the abundance of comments and the attention to detail. Test everything.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/tjcsl/ion/blob/dev/intranet/apps/polls/tests.py">Polls</a> - Note the throughness of the checks; assertions are made even when nothing should have changed.</p></li>
<li><p><a class="reference external" href="https://github.com/tjcsl/ion/blob/dev/intranet/apps/emailfwd/tests.py">Emailfwd</a> - Note the use of <cite>self.client</cite> and checking <cite>messages</cite> generated by the page.</p></li>
<li><p><a class="reference external" href="https://github.com/tjcsl/ion/tree/dev/intranet/apps/eighth/tests">Eighth</a> - <code class="docutils literal notranslate"><span class="pre">eighth</span></code> is the most complicated app in Ion and thus has the most varied examples of testing methods to check out.</p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.djangoproject.com/en/3.2/topics/testing">Django Testing Guide</a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/unittest.html">Python unittest documentation</a>.</p></li>
<li><p><a class="reference external" href="https://coveralls.io/github/tjcsl/ion">Code Coverage</a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/unittest.html#assert-methods">Python Unit Testing Frameworkgood</a>.</p></li>
<li><p><a class="reference external" href="https://docs.djangoproject.com/en/3.2/topics/testing/tools/#exceptions">Testing Exceptions</a>.</p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2022, TJ Intranet Development Team.<br/>
    </p>
  </div>
</footer>
  </body>
</html>